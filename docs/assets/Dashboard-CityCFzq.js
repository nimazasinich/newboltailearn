var b=Object.defineProperty;var v=(n,s,t)=>s in n?b(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var f=(n,s,t)=>v(n,typeof s!="symbol"?s+"":s,t);import{c as N,r as i,W as w,j as e,B as k,A as C,T as S}from"./index-D9f6-iYK.js";import{C as d,a as h,b as x,c as m}from"./Card-DmHR_EnP.js";import{C as E}from"./chart-pie-BWasDpd3.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],A=N("chart-line",$);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]],W=N("chart-no-axes-column-increasing",T),P="https://newboltailearn-2.onrender.com/api";async function I(n,s){const t=await fetch(`${P}${n}`,{headers:{"Content-Type":"application/json",...s==null?void 0:s.headers},credentials:"include",...s});if(!t.ok)throw new Error(`API Error: ${t.status} - ${t.statusText}`);return t.json()}function y(n,s,t=[]){const[a,r]=i.useState(null),[l,c]=i.useState(!0),[j,o]=i.useState(null),p=i.useCallback(async()=>{c(!0),o(null);try{const u=await I(n,s);r(u),c(!1)}catch(u){o((u==null?void 0:u.message)||"Error"),c(!1)}},[n,...t||[]]);return i.useEffect(()=>{p()},[p]),{data:a,loading:l,error:j,refetch:p}}class _{constructor(){f(this,"ws",null);f(this,"listeners",new Map);f(this,"attempts",0);f(this,"max",5)}url(){return w.startsWith("/")?`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}${w}`:w}connect(){return new Promise((s,t)=>{try{this.ws=new WebSocket(this.url()),this.ws.onopen=()=>{this.attempts=0,s()},this.ws.onmessage=a=>{try{const r=JSON.parse(a.data);this.emit(r)}catch{}},this.ws.onclose=()=>{this.reconnect()},this.ws.onerror=a=>{t(a)}}catch(a){t(a)}})}reconnect(){this.attempts>=this.max||(this.attempts++,setTimeout(()=>this.connect().catch(()=>{}),this.attempts*1e3))}on(s,t){return this.listeners.has(s)||this.listeners.set(s,new Set),this.listeners.get(s).add(t),()=>this.listeners.get(s).delete(t)}emit(s){const t=this.listeners.get(s.type);t&&t.forEach(r=>r(s.data));const a=this.listeners.get("*");a&&a.forEach(r=>r(s))}send(s,t){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:s,data:t,timestamp:Date.now()}))}get connected(){var s;return((s=this.ws)==null?void 0:s.readyState)===WebSocket.OPEN}}const g=new _;function L(){const[n,s]=i.useState(!1),t=i.useRef([]);return i.useEffect(()=>{g.connect().then(()=>s(!0)).catch(()=>s(!1));const r=setInterval(()=>s(g.connected),1e3);return()=>{clearInterval(r),t.current.forEach(l=>l()),t.current=[]}},[]),{connected:n,subscribe:(r,l)=>{const c=g.on(r,l);return t.current.push(c),c},send:g.send.bind(g)}}function H(){const{data:n,loading:s}=y("/models"),{loading:t}=y("/monitoring"),{connected:a,subscribe:r}=L();return i.useEffect(()=>{const c=r("system:metrics",o=>{console.log("Received system metrics:",o)}),j=r("training:progress",o=>{console.log("Received training progress:",o)});return()=>{c(),j()}},[r]),s||t?e.jsx("div",{className:"flex items-center justify-center h-64",dir:"rtl",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"داشبورد پیشرفته"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"نمای جامع از عملکرد سیستم و مدل‌های آموزشی"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"وضعیت اتصال:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a?"متصل":"قطع شده"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"کل مدل‌ها"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-2xl font-bold",children:(n==null?void 0:n.length)||0})})]}),e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"جلسات فعال"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-2xl font-bold",children:(n==null?void 0:n.filter(c=>c.status==="training").length)||0})})]}),e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"متوسط دقت"}),e.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-2xl font-bold",children:"87.5%"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"نمودار عملکرد مدل‌ها"]})}),e.jsx(m,{children:e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"نمودار در حال توسعه است"})})]}),e.jsxs(d,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"روند آموزش"]})}),e.jsx(m,{children:e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"نمودار در حال توسعه است"})})]})]}),e.jsxs(d,{children:[e.jsx(h,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"توزیع انواع مدل‌ها"]})}),e.jsx(m,{children:e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"نمودار در حال توسعه است"})})]})]})}export{H as default};
//# sourceMappingURL=Dashboard-CityCFzq.js.map
