import{c as D,r as c,j as e,A as E,B as T,F as B,T as F,a as u}from"./index-32c28655.js";import{C as d,a as x,b as m,c as i}from"./Card-b44d7dcb.js";import{B as I}from"./Badge-06a01429.js";import{P as p}from"./Progress-e89440bd.js";import{w as g}from"./wsClient-d7b77ecb.js";import{R as _}from"./refresh-cw-1eccc20a.js";import{A as M}from"./alert-circle-35e612e9.js";import{C as $,H}from"./hard-drive-84d9ef96.js";const U=D("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function W(){const[a,b]=c.useState(null),[l,N]=c.useState([]),[j,S]=c.useState([]),[y,v]=c.useState(!0),[w,f]=c.useState(null);c.useEffect(()=>{(async()=>{try{v(!0),f(null);const[t,r,h]=await Promise.allSettled([u.monitoring(),u.models(),u.datasets()]);t.status==="fulfilled"&&b(t.value),r.status==="fulfilled"&&N(r.value),h.status==="fulfilled"&&S(h.value),t.status==="rejected"&&r.status==="rejected"&&h.status==="rejected"&&f("خطا در بارگذاری داده‌ها")}catch(t){console.error("Failed to load overview data:",t),f("خطا در بارگذاری داده‌ها")}finally{v(!1)}})()},[]),c.useEffect(()=>{const s=r=>{r.data&&b(r.data)},t=r=>{r.data&&u.models().then(N).catch(console.error)};return g.on("system_metrics",s),g.on("training_progress",t),()=>{g.off("system_metrics",s),g.off("training_progress",t)}},[]);const n=s=>s.toLocaleString("fa-IR"),o=(s,t=1)=>`${s.toFixed(t).replace(".","/")}%`,P=s=>{const t=Math.floor(s/86400),r=Math.floor(s%86400/3600),h=Math.floor(s%3600/60);return t>0?`${n(t)} روز`:r>0?`${n(r)} ساعت`:`${n(h)} دقیقه`},k=l.filter(s=>s.status==="training"||s.status==="running").length,R=l.filter(s=>s.status==="completed").length,A=l.length>0?Math.max(...l.map(s=>s.accuracy||0)):0,C=l.length>0?l.reduce((s,t)=>s+(t.accuracy||0),0)/l.length:0,L=j.reduce((s,t)=>s+(t.samples||0),0);return y?e.jsx("div",{className:"space-y-6",dir:"rtl",children:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"در حال بارگذاری داده‌ها..."})]})})}):e.jsxs("div",{className:"space-y-6",dir:"rtl","data-testid":"overview-page",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"نمای کلی سیستم"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["آخرین بروزرسانی: ",a?new Date(a.timestamp).toLocaleString("fa-IR"):"نامشخص"]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-2 px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-950 rounded-md transition-colors",children:[e.jsx(_,{className:"h-4 w-4"}),"بروزرسانی"]})]}),w&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 dark:bg-yellow-950 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-yellow-600"}),e.jsx("p",{className:"text-yellow-800 dark:text-yellow-200",children:w})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(d,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"وضعیت سیستم"}),e.jsx(E,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:e.jsx(I,{variant:a?"default":"secondary",children:a?"سالم":"نامشخص"})}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:["آپ‌تایم: ",a?P(a.uptime):"نامشخص"]})]})]}),e.jsxs(d,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"جلسات آموزش فعال"}),e.jsx(T,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:n(k)}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-2",children:["کل مدل‌ها: ",n(l.length)]})]})]}),e.jsxs(d,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"دیتاست‌ها"}),e.jsx(B,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:n(j.length)}),e.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400 mt-2",children:["کل نمونه‌ها: ",n(L)]})]})]}),e.jsxs(d,{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"بهترین دقت"}),e.jsx(F,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-900 dark:text-orange-100",children:o(A*100)}),e.jsxs("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-2",children:["متوسط: ",o(C*100)]})]})]})]}),a&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(x,{children:e.jsxs(m,{className:"flex items-center gap-3",children:[e.jsx($,{className:"h-5 w-5"}),"منابع سیستم"]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"CPU"}),e.jsx("span",{className:"font-bold",children:o(a.cpu)})]}),e.jsx(p,{value:a.cpu,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"حافظه"}),e.jsx("span",{className:"font-bold",children:o(a.memory.percentage)})]}),e.jsx(p,{value:a.memory.percentage,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"فضای ذخیره"}),e.jsx("span",{className:"font-bold",children:o(a.disk.percentage)})]}),e.jsx(p,{value:a.disk.percentage,className:"h-2"})]})]})]}),e.jsxs(d,{children:[e.jsx(x,{children:e.jsxs(m,{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-5 w-5"}),"آمار آموزش"]})}),e.jsxs(i,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n(R)}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"تکمیل شده"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n(k)}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"در حال اجرا"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"میانگین دقت کلی"}),e.jsx("span",{className:"font-bold",children:o(C*100)})]})})]})]})]}),!a&&!l.length&&!j.length&&!y&&e.jsx(d,{children:e.jsxs(i,{className:"text-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"داده‌ای یافت نشد"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"هیچ داده‌ای از سرور دریافت نشد. لطفاً وضعیت اتصال را بررسی کنید."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"تلاش مجدد"})]})})]})}export{W as Overview,W as default};
//# sourceMappingURL=Overview-ae77ed92.js.map
